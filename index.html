    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Our Lady of Fatima Shrine Census Form</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <style>
            body {
                font-family: 'Inter', sans-serif;
                background-color: #f3f4f6;
            }
            .form-section {
                border-radius: 1rem;
                padding: 2rem;
                margin-bottom: 2rem;
            }
            .card {
                background-color: white;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                border-radius: 1rem;
                padding: 1.5rem;
                margin-top: 1.5rem;
            }
            .bg-gradient-blue {
                background: linear-gradient(135deg, #1d4ed8, #3b82f6);
            }
            .bg-gradient-green {
                background: linear-gradient(135deg, #059669, #10b981);
            }
            .bg-gradient-red {
                background: linear-gradient(135deg, #dc2626, #ef4444);
            }
            .sub-section {
                border-left: 4px solid #d1d5db;
                padding-left: 1rem;
                margin-left: 1rem;
                margin-top: 1rem;
            }
        </style>
    </head>
    <body class="p-8 md:p-12">
        <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-xl p-8 md:p-12">
            <header class="text-center mb-10">
                <img src="https://placehold.co/150x150/374151/FFFFFF?text=Logo" alt="Our Lady of Fatima Logo" class="mx-auto mb-4 rounded-full shadow-lg">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Our Lady of Fatima Shrine</h1>
                <p class="text-gray-600 text-lg">Household Census Form</p>
                <div id="messageBox" class="mt-4 p-4 rounded-lg text-sm text-center font-semibold hidden"></div>
            </header>
            
            <form id="censusForm" class="space-y-10">
                <!-- Household Information Section -->
                <div class="form-section bg-blue-50 text-gray-800">
                    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2"><i class="fa-solid fa-house"></i> Household Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label for="blockName" class="block font-medium">Block Name</label>
                            <input type="text" id="blockName" name="blockName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300" required>
                        </div>
                        <div class="space-y-2">
                            <label for="residentialAddress" class="block font-medium">Residential Address</label>
                            <input type="text" id="residentialAddress" name="residentialAddress" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300" required>
                        </div>
                        <div class="space-y-2 col-span-1 md:col-span-2">
                            <label for="contactInformation" class="block font-medium">Contact Information (Main Member)</label>
                            <input type="tel" id="contactInformation" name="contactInformation" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300" required>
                        </div>
                    </div>
                </div>

                <!-- Members Information Section -->
                <div class="form-section bg-green-50 text-gray-800">
                    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2"><i class="fa-solid fa-user-group"></i> Members' Information</h2>
                    <div id="membersContainer" class="space-y-6">
                        <!-- Dynamic member forms will be added here -->
                    </div>
                    <button type="button" id="addMemberBtn" class="mt-6 w-full md:w-auto px-6 py-3 bg-gradient-green text-white rounded-full font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
                        <i class="fa-solid fa-plus mr-2"></i> Add Another Member
                    </button>
                </div>

                <!-- Children Information Section -->
                <div class="form-section bg-red-50 text-gray-800">
                    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2"><i class="fa-solid fa-child"></i> Children's Information</h2>
                    <div id="childrenContainer" class="space-y-6">
                        <!-- Dynamic children forms will be added here -->
                    </div>
                    <button type="button" id="addChildBtn" class="mt-6 w-full md:w-auto px-6 py-3 bg-gradient-red text-white rounded-full font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
                        <i class="fa-solid fa-plus mr-2"></i> Add Another Child
                    </button>
                </div>

                <div class="flex justify-center">
                    <button type="submit" id="submitBtn" class="w-full md:w-64 px-8 py-4 bg-gradient-blue text-white rounded-full font-bold text-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105">
                        Submit Census Form
                    </button>
                </div>
            </form>
        </div>

        <script>
            // Paste your Google Apps Script Web App URL here
            const API_URL = 'https://script.google.com/macros/s/AKfycbzqnDiJx3hC1AZ8CXFclW-E7mO7VwKEfajOCxdK9Y19sQAqSlfP7UB3vHK4_VUMTTeN/exec'; // *** IMPORTANT: REPLACE THIS WITH YOUR DEPLOYED URL ***
            
            document.addEventListener('DOMContentLoaded', () => {
                const addMemberBtn = document.getElementById('addMemberBtn');
                const addChildBtn = document.getElementById('addChildBtn');
                const censusForm = document.getElementById('censusForm');
                const membersContainer = document.getElementById('membersContainer');
                const childrenContainer = document.getElementById('childrenContainer');
                const messageBox = document.getElementById('messageBox');

                let memberCount = 0;
                let childCount = 0;

                function addMemberForm() {
                    memberCount++;
                    const memberDiv = document.createElement('div');
                    memberDiv.className = 'card';
                    memberDiv.innerHTML = `
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold">Member #${memberCount}</h3>
                            <button type="button" class="remove-btn text-gray-400 hover:text-red-500 transition duration-300" data-id="${memberCount}"><i class="fa-solid fa-xmark"></i></button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block font-medium">First Name</label>
                                <input type="text" name="member-${memberCount}-firstName" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Last Name</label>
                                <input type="text" name="member-${memberCount}-lastName" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Date of Birth</label>
                                <input type="date" name="member-${memberCount}-dateOfBirth" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Catholic?</label>
                                <select name="member-${memberCount}-catholic" class="form-input" required>
                                    <option value="">Select...</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div>
                                <label class="block font-medium">Occupation</label>
                                <input type="text" name="member-${memberCount}-occupation" class="form-input">
                            </div>
                            <div>
                                <label class="block font-medium">Church Activities</label>
                                <input type="text" name="member-${memberCount}-churchActivities" class="form-input">
                            </div>
                            <div>
                                <label class="block font-medium">Solidarity/Ministry</label>
                                <input type="text" name="member-${memberCount}-solidarityMinistry" class="form-input">
                            </div>
                            <div>
                                <label class="block font-medium">Leadership</label>
                                <input type="text" name="member-${memberCount}-leadership" class="form-input">
                            </div>
                        </div>

                        <!-- Sacrament and Marital Status Sections -->
                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">Baptism</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">Baptised?</label>
                                <select name="member-${memberCount}-baptised" class="form-input baptized-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="baptised-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date of Baptism</label>
                                    <input type="date" name="member-${memberCount}-baptismDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Registration Number</label>
                                    <input type="text" name="member-${memberCount}-baptismRegistrationNo" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church of Baptism</label>
                                    <input type="text" name="member-${memberCount}-churchOfBaptism" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Location of Church</label>
                                    <input type="text" name="member-${memberCount}-locationOfChurch" class="form-input">
                                </div>
                            </div>
                        </div>

                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">First Communion</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">1st Communion?</label>
                                <select name="member-${memberCount}-firstCommunion" class="form-input communion-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="communion-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date 1st Communion</label>
                                    <input type="date" name="member-${memberCount}-firstCommunionDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church of 1st Communion</label>
                                    <input type="text" name="member-${memberCount}-churchOfFirstCommunion" class="form-input">
                                </div>
                            </div>
                        </div>

                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">Confirmation</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">Confirmed?</label>
                                <select name="member-${memberCount}-confirmation" class="form-input confirmation-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="confirmation-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date of Confirmation</label>
                                    <input type="date" name="member-${memberCount}-confirmationDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church of Confirmation</label>
                                    <input type="text" name="member-${memberCount}-churchOfConfirmation" class="form-input">
                                </div>
                            </div>
                        </div>

                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">Marital Status</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">Marital Status</label>
                                <select name="member-${memberCount}-maritalStatus" class="form-input marital-status-select">
                                    <option value="Single">Single</option>
                                    <option value="Married">Married</option>
                                    <option value="Widower">Widow(er)</option>
                                </select>
                            </div>
                            <div class="marital-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Civil Court Marriage Date</label>
                                    <input type="date" name="member-${memberCount}-civilCourtMarriageDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church Marriage Date</label>
                                    <input type="date" name="member-${memberCount}-churchMarriageDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church Marriage Place</label>
                                    <input type="text" name="member-${memberCount}-churchMarriagePlace" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Divorced?</label>
                                    <select name="member-${memberCount}-divorced" class="form-input">
                                        <option value="No">No</option>
                                        <option value="Yes">Yes</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">Dikabelo</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">Dikabelo?</label>
                                <select name="member-${memberCount}-dikabelo" class="form-input dikabelo-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="dikabelo-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date of Last Dikabelo</label>
                                    <input type="date" name="member-${memberCount}-dateOfLastDikabelo" class="form-input">
                                </div>
                            </div>
                        </div>
                    </div>
                    `;
                    membersContainer.appendChild(memberDiv);
                    memberDiv.querySelector('.remove-btn').addEventListener('click', () => memberDiv.remove());
                    setupConditionalFields(memberDiv);
                }

                function addChildForm() {
                    childCount++;
                    const childDiv = document.createElement('div');
                    childDiv.className = 'card';
                    childDiv.innerHTML = `
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold">Child #${childCount}</h3>
                            <button type="button" class="remove-btn text-gray-400 hover:text-red-500 transition duration-300" data-id="${childCount}"><i class="fa-solid fa-xmark"></i></button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block font-medium">First Name</label>
                                <input type="text" name="child-${childCount}-firstName" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Last Name</label>
                                <input type="text" name="child-${childCount}-lastName" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Date of Birth</label>
                                <input type="date" name="child-${childCount}-dateOfBirth" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Age</label>
                                <input type="number" name="child-${childCount}-age" class="form-input" required>
                            </div>
                            <div>
                                <label class="block font-medium">Catholic?</label>
                                <select name="child-${childCount}-catholic" class="form-input" required>
                                    <option value="">Select...</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div>
                                <label class="block font-medium">Church Activities</label>
                                <input type="text" name="child-${childCount}-churchActivities" class="form-input">
                            </div>
                        </div>

                        <!-- Sacrament Sections for Children -->
                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">Baptism</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">Baptised?</label>
                                <select name="child-${childCount}-baptised" class="form-input baptized-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="baptised-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date of Baptism</label>
                                    <input type="date" name="child-${childCount}-baptismDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Registration Number</label>
                                    <input type="text" name="child-${childCount}-baptismRegistrationNo" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church of Baptism</label>
                                    <input type="text" name="child-${childCount}-churchOfBaptism" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Location of Church</label>
                                    <input type="text" name="child-${childCount}-locationOfChurch" class="form-input">
                                </div>
                            </div>
                        </div>

                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">First Communion</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">1st Communion?</label>
                                <select name="child-${childCount}-firstCommunion" class="form-input communion-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="communion-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date 1st Communion</label>
                                    <input type="date" name="child-${childCount}-firstCommunionDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church of 1st Communion</label>
                                    <input type="text" name="child-${childCount}-churchOfFirstCommunion" class="form-input">
                                </div>
                            </div>
                        </div>

                        <div class="sub-section">
                            <h4 class="font-bold text-sm text-gray-600 mb-2">Confirmation</h4>
                            <div class="space-y-2">
                                <label class="block font-medium">Confirmed?</label>
                                <select name="child-${childCount}-confirmation" class="form-input confirmation-select">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="confirmation-fields hidden mt-2 space-y-2">
                                <div>
                                    <label class="block font-medium">Date of Confirmation</label>
                                    <input type="date" name="child-${childCount}-confirmationDate" class="form-input">
                                </div>
                                <div>
                                    <label class="block font-medium">Church of Confirmation</label>
                                    <input type="text" name="child-${childCount}-churchOfConfirmation" class="form-input">
                                </div>
                            </div>
                        </div>
                    `;
                    childrenContainer.appendChild(childDiv);
                    childDiv.querySelector('.remove-btn').addEventListener('click', () => childDiv.remove());
                    setupConditionalFields(childDiv);
                }

                function setupConditionalFields(container) {
                    container.querySelectorAll('.baptized-select').forEach(select => {
                        select.addEventListener('change', (e) => {
                            const fields = container.querySelector('.baptised-fields');
                            if (e.target.value === 'Yes') {
                                fields.classList.remove('hidden');
                            } else {
                                fields.classList.add('hidden');
                            }
                        });
                    });
                    container.querySelectorAll('.communion-select').forEach(select => {
                        select.addEventListener('change', (e) => {
                            const fields = container.querySelector('.communion-fields');
                            if (e.target.value === 'Yes') {
                                fields.classList.remove('hidden');
                            } else {
                                fields.classList.add('hidden');
                            }
                        });
                    });
                    container.querySelectorAll('.confirmation-select').forEach(select => {
                        select.addEventListener('change', (e) => {
                            const fields = container.querySelector('.confirmation-fields');
                            if (e.target.value === 'Yes') {
                                fields.classList.remove('hidden');
                            } else {
                                fields.classList.add('hidden');
                            }
                        });
                    });
                    container.querySelectorAll('.marital-status-select').forEach(select => {
                        select.addEventListener('change', (e) => {
                            const fields = container.querySelector('.marital-fields');
                            if (e.target.value === 'Married' || e.target.value === 'Widower') {
                                fields.classList.remove('hidden');
                            } else {
                                fields.classList.add('hidden');
                            }
                        });
                    });
                    container.querySelectorAll('.dikabelo-select').forEach(select => {
                        select.addEventListener('change', (e) => {
                            const fields = container.querySelector('.dikabelo-fields');
                            if (e.target.value === 'Yes') {
                                fields.classList.remove('hidden');
                            } else {
                                fields.classList.add('hidden');
                            }
                        });
                    });
                }
                
                addMemberForm(); // Add one member form by default
                addChildForm(); // Add one child form by default

                addMemberBtn.addEventListener('click', addMemberForm);
                addChildBtn.addEventListener('click', addChildForm);

                censusForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    showMessage('Submitting form...', 'bg-blue-200 text-blue-800');

                    const formData = new FormData(censusForm);
                    const householdData = {
                        blockName: formData.get('blockName'),
                        residentialAddress: formData.get('residentialAddress'),
                        contactInformation: formData.get('contactInformation'),
                    };

                    const membersData = [];
                    for (let i = 1; i <= memberCount; i++) {
                        if (document.querySelector(`input[name="member-${i}-firstName"]`)) {
                            membersData.push({
                                firstName: formData.get(`member-${i}-firstName`),
                                lastName: formData.get(`member-${i}-lastName`),
                                dateOfBirth: formData.get(`member-${i}-dateOfBirth`),
                                catholic: formData.get(`member-${i}-catholic`),
                                occupation: formData.get(`member-${i}-occupation`),
                                churchActivities: formData.get(`member-${i}-churchActivities`),
                                solidarityMinistry: formData.get(`member-${i}-solidarityMinistry`),
                                leadership: formData.get(`member-${i}-leadership`),
                                baptised: formData.get(`member-${i}-baptised`),
                                baptismDate: formData.get(`member-${i}-baptismDate`),
                                baptismRegistrationNo: formData.get(`member-${i}-baptismRegistrationNo`),
                                churchOfBaptism: formData.get(`member-${i}-churchOfBaptism`),
                                locationOfChurch: formData.get(`member-${i}-locationOfChurch`),
                                firstCommunion: formData.get(`member-${i}-firstCommunion`),
                                firstCommunionDate: formData.get(`member-${i}-firstCommunionDate`),
                                churchOfFirstCommunion: formData.get(`member-${i}-churchOfFirstCommunion`),
                                confirmation: formData.get(`member-${i}-confirmation`),
                                confirmationDate: formData.get(`member-${i}-confirmationDate`),
                                churchOfConfirmation: formData.get(`member-${i}-churchOfConfirmation`),
                                maritalStatus: formData.get(`member-${i}-maritalStatus`),
                                civilCourtMarriageDate: formData.get(`member-${i}-civilCourtMarriageDate`),
                                churchMarriageDate: formData.get(`member-${i}-churchMarriageDate`),
                                churchMarriagePlace: formData.get(`member-${i}-churchMarriagePlace`),
                                divorced: formData.get(`member-${i}-divorced`),
                                dikabelo: formData.get(`member-${i}-dikabelo`),
                                dateOfLastDikabelo: formData.get(`member-${i}-dateOfLastDikabelo`),
                            });
                        }
                    }

                    const childrenData = [];
                    for (let i = 1; i <= childCount; i++) {
                        if (document.querySelector(`input[name="child-${i}-firstName"]`)) {
                            childrenData.push({
                                firstName: formData.get(`child-${i}-firstName`),
                                lastName: formData.get(`child-${i}-lastName`),
                                dateOfBirth: formData.get(`child-${i}-dateOfBirth`),
                                age: formData.get(`child-${i}-age`),
                                catholic: formData.get(`child-${i}-catholic`),
                                churchActivities: formData.get(`child-${i}-churchActivities`),
                                baptised: formData.get(`child-${i}-baptised`),
                                baptismDate: formData.get(`child-${i}-baptismDate`),
                                baptismRegistrationNo: formData.get(`child-${i}-baptismRegistrationNo`),
                                churchOfBaptism: formData.get(`child-${i}-churchOfBaptism`),
                                locationOfChurch: formData.get(`child-${i}-locationOfChurch`),
                                firstCommunion: formData.get(`child-${i}-firstCommunion`),
                                firstCommunionDate: formData.get(`child-${i}-firstCommunionDate`),
                                churchOfFirstCommunion: formData.get(`child-${i}-churchOfFirstCommunion`),
                                confirmation: formData.get(`child-${i}-confirmation`),
                                confirmationDate: formData.get(`child-${i}-confirmationDate`),
                                churchOfConfirmation: formData.get(`child-${i}-churchOfConfirmation`),
                            });
                        }
                    }
                    
                    const payload = { household: householdData, members: membersData, children: childrenData };
                    
                    try {
                        const response = await fetch(API_URL, {
                            method: 'POST',
                            mode: 'no-cors', // Required for Google Apps Script
                            body: JSON.stringify(payload),
                            headers: {
                                'Content-Type': 'application/json',
                            }
                        });

                        showMessage('Form submitted successfully! Thank you.', 'bg-green-200 text-green-800');
                        censusForm.reset();
                        membersContainer.innerHTML = '';
                        childrenContainer.innerHTML = '';
                        memberCount = 0;
                        childCount = 0;
                        addMemberForm();
                        addChildForm();
                    } catch (error) {
                        showMessage('An error occurred. Please try again.', 'bg-red-200 text-red-800');
                        console.error('Error submitting form:', error);
                    }
                });

                function showMessage(message, colorClass) {
                    messageBox.textContent = message;
                    messageBox.className = `mt-4 p-4 rounded-lg text-sm text-center font-semibold ${colorClass} visible`;
                    messageBox.classList.remove('hidden');
                }
            });
        </script>
    </body>
    </html>
    
